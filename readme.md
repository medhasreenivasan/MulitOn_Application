# VisualAI Assistant: Empowering Actions through Images

## Introduction
The goal of the Project was to create an end-to-end AI application that takes an input image screenshot and translates it into browser actions to complete a task using the MultiOn API. The project aimed to demonstrate the capabilities of visual language models (VLMs) in generating commands from images, converting these commands into browser actions using the MultiOn API, and verifying the completion of tasks.

## Approach

### Visual Language Model Selection
I evaluated the quality of captions generated by 4 states of the art models like BLIP-CAPTION, VIT-GPT2, LLAVA-1.5, and GIT-BASE model. While all four models gave somewhat similar outcomes, BLIP-CAPTION gave the most concise and accurate caption.

### Getting browser commands from GPT (gpt-3.5-turbo-0125)
Performed few shot training with GPT model by providing some examples and desired format for the browser commands.

### Integration with MultiOn API
The obtained browser commands are then used to trigger the local multion browser extension API and the agent performs the task!

### End to end testing with 3 use cases
- Posting content on twitter
- Ordering items from amazon
- Ordering food from uber eats

### FAST API setup
The application which takes in the image/screenshot and the user command as inputs was hosted using fast API. Ngrok was used to provide a temporary public link which could be accessed from a jupyter notebook/colab.

### User Interface
The UI was implemented with gradio.

### Implementation with LLAVA model
In order to eliminate the need for the middle model GPT for completion of prompts, I attempted to use LLAVA model to generate the browser commands directly. Prompt engineering was done to find the most suitable prompt that could give consistent results from LLAVA model. While the results were mostly consistent, the performance of BLIP+GPT was more consistent than using LLAVA model alone.

### Bottlenecks
- Getting consistent results from LLAVA model
- Version mismatches from the LAVIS models and the transformers versions
- Setting up a temporary ngrok connection to establish proper communication between the fastapi application and the end user.
- Error Handling: Designing robust error handling mechanisms to handle unexpected scenarios effectively was challenging.

## EVALUATING SOTA VLM MODELS
For validating the VLM models, I created a small validation dataset with the most frequently ordered items from Ubereats based on their latest report[reference]. The dataset consists of 10 images of top 5 ordereded dishes according to ubereats. Four models were chosen to perform the validation:
- Blip caption model.
- VIT-GPT2 model
- GIT-BASE model
- LLAVA model
The inference results for some of the images are shown below:

| Image                      | BLIP-BASE                                            | VIT-GPT2                                          | GIT-BASE                                         | LLAVA-1.5                                        |
|----------------------------|------------------------------------------------------|---------------------------------------------------|--------------------------------------------------|--------------------------------------------------|
| French fries               | an image of french fries with salt.                  | a plate of food with onions carrots and cheese    | fries and fries on a wooden table                | These are french fries, which are a popular side dish made from potatoes. They are typically deep-fried and served with various dipping sauces. In the image, the fries are placed on a wooden table, and they are accompanied by a tomato and a pepper, which can be used as condiments or ingredients for a more flavorful dish.    |
| Plate of naan              | an image of a plate of naan naan                     | a plate of food with some bread                   | a close up of a white tortilla on a blue background | These are flatbreads, which are thin, unleavened breads made from wheat flour. They are often used as a base for various dishes, such as pizzas, sandwiches, and wraps. In the image, the flatbreads are topped with a mixture of herbs and oil, which adds flavor and moisture to the bread.           |
| Two bowls of soup          | an image of two bowls of soup with a spoon.          | a bowl of soup with a spoon and a spoonful of vegetables | a white spoon in a soup                         | These are bowls of soup, likely containing tofu and vegetables. The bowls are placed on a dining table, and there are spoons in them, ready for use. The soup appears to be a warm and comforting meal, perfect for a chilly day.|
| Shrimp pad noodles         | an image of shrimp pad noodles in a pan.             | a bowl of noodles with shrimp and vegetables      | a recipe for shrimp with shrimp and vegetables   | These are shrimp and noodles, served in a bowl. The dish appears to be a combination of shrimp and noodles, possibly with some vegetables and sauce. The shrimp are cooked and placed on top of the noodles, creating a delicious and appetizing meal. |



### Comparative Study

| VLM        | PROS                                                 | CONS                                    |
|------------|------------------------------------------------------|-----------------------------------------|
| BLIP-BASE  | Concise outcomes which will help the GPT model give desirable browser commands. Mostly accurate on what type of food/dish | Tendency to repeat                      |
| VIT-GPT2   | Concise outcomes which will help the GPT model give desirable browser commands. | Not reliable due to the inaccurate generations for some of the images |
| GIT-BASE   | Concise outcomes which will help the GPT model give desirable browser commands. | Not reliable due to the inaccurate generations for some of the images. Tendency to repeat words |
| LLAVA-1.5  | Can generate the ingredients/dish precisely most times | Too descriptive which can affect the browser command generation by GPT |

## FUTURE IMPROVEMENTS
- Deploy the application to cloud.
- Finetune the models to adapt to a specific task/ improve the image captioning abilities of the model.
- Evaluate the custom dataset against user generated captions.
- Further prompt engineering to improve llava-1.5 modelâ€™s consistency.
